import type { IndividualFunctionTest } from '../../types/spreadsheet';

export const databaseTests: IndividualFunctionTest[] = [
  {
    name: 'DSUM',
    category: '10. データベース',
    description: '条件付き合計',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '開発', 120],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DSUM(A1:C4,C1,A6:A7)']
    ],
    expectedValues: { 'C7': 250 }
  },
  {
    name: 'DAVERAGE',
    category: '10. データベース',
    description: '条件付き平均',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '開発', 120],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DAVERAGE(A1:C4,C1,A6:A7)']
    ],
    expectedValues: { 'C7': 125 }
  },
  {
    name: 'DCOUNT',
    category: '10. データベース',
    description: '条件付きカウント',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '開発', 120],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DCOUNT(A1:C4,C1,A6:A7)']
    ],
    expectedValues: { 'C7': 2 }
  },
  {
    name: 'DCOUNTA',
    category: '10. データベース',
    description: '条件付き非空白カウント',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', ''],
      ['鈴木', '開発', 120],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DCOUNTA(A1:C4,A1,A6:A7)']
    ],
    expectedValues: { 'C7': 2 }
  },
  {
    name: 'DMAX',
    category: '10. データベース',
    description: '条件付き最大値',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '開発', 120],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DMAX(A1:C4,C1,A6:A7)']
    ],
    expectedValues: { 'C7': 150 }
  },
  {
    name: 'DMIN',
    category: '10. データベース',
    description: '条件付き最小値',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '開発', 120],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DMIN(A1:C4,C1,A6:A7)']
    ],
    expectedValues: { 'C7': 100 }
  },
  {
    name: 'DPRODUCT',
    category: '10. データベース',
    description: '条件付き積',
    data: [
      ['商品', 'カテゴリ', '数量'],
      ['A', '文具', 2],
      ['B', '文具', 3],
      ['C', '家電', 4],
      ['', '', ''],
      ['条件', '', ''],
      ['カテゴリ', '', ''],
      ['文具', '', '=DPRODUCT(A1:C4,C1,A6:A7)']
    ],
    expectedValues: { 'C7': 6 }
  },
  {
    name: 'DSTDEV',
    category: '10. データベース',
    description: '条件付き標準偏差',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '営業', 200],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DSTDEV(A1:C4,C1,A6:A7)']
    ]
  },
  {
    name: 'DSTDEVP',
    category: '10. データベース',
    description: '条件付き母標準偏差',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '営業', 200],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DSTDEVP(A1:C4,C1,A6:A7)']
    ]
  },
  {
    name: 'DVAR',
    category: '10. データベース',
    description: '条件付き分散',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '営業', 200],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DVAR(A1:C4,C1,A6:A7)']
    ]
  },
  {
    name: 'DVARP',
    category: '10. データベース',
    description: '条件付き母分散',
    data: [
      ['名前', '部署', '売上'],
      ['田中', '営業', 100],
      ['佐藤', '営業', 150],
      ['鈴木', '営業', 200],
      ['', '', ''],
      ['条件', '', ''],
      ['部署', '', ''],
      ['営業', '', '=DVARP(A1:C4,C1,A6:A7)']
    ]
  },
  {
    name: 'DGET',
    category: '10. データベース',
    description: '条件に一致する単一値',
    data: [
      ['ID', '名前', '部署'],
      [101, '田中', '営業'],
      [102, '佐藤', '技術'],
      [103, '鈴木', '人事'],
      ['', '', ''],
      ['条件', '', ''],
      ['ID', '', ''],
      [102, '', '=DGET(A1:C4,B1,A6:A7)']
    ],
    expectedValues: { 'C7': '佐藤' }
  }
];
