/**
 * DemoSpreadsheetコンポーネントで使用するデモデータ
 * 各種エクセル関数の動作確認用サンプルデータを含む
 * ※ これはテストコード用ではなく、画面表示用のデモデータです
 */

export interface DemoCategory {
  id: string;
  name: string;
  description: string;
  color: string;
  data: (string | number | null)[][];
  expectedResults?: { [key: string]: string | number };
}

// 画面で表示するカテゴリ別のデモデータ
export const demoSpreadsheetData: DemoCategory[] = [
  {
    id: 'basic',
    name: '基本関数',
    description: '基本的な数式と関数の動作確認',
    color: 'blue',
    data: [
      ['項目', '1月', '2月', '3月', '合計', '平均'],
      ['売上A', 100000, 150000, 120000, '=SUM(B2:D2)', '=AVERAGE(B2:D2)'],
      ['売上B', 80000, 90000, 110000, '=SUM(B3:D3)', '=AVERAGE(B3:D3)'],
      ['売上C', 120000, 100000, 130000, '=SUM(B4:D4)', '=AVERAGE(B4:D4)'],
      ['合計', '=SUM(B2:B4)', '=SUM(C2:C4)', '=SUM(D2:D4)', '=SUM(E2:E4)', '=AVERAGE(E2:E4)'],
    ],
    expectedResults: {
      'E2': 370000,
      'F2': 123333.33,
      'E3': 280000,
      'F3': 93333.33,
      'E4': 350000,
      'F4': 116666.67,
      'B5': 300000,
      'C5': 340000,
      'D5': 360000,
      'E5': 1000000,
      'F5': 333333.33
    }
  },
  {
    id: 'math',
    name: '数学・三角関数',
    description: '基本的な計算、集計、条件付き集計などのテスト',
    color: 'orange',
    data: [
      ['商品', '単価', '数量', '金額', '税込'],
      ['商品A', 1000, 5, '=B2*C2', '=D2*1.1'],
      ['商品B', 2500, 3, '=B3*C3', '=D3*1.1'],
      ['商品C', 800, 10, '=B4*C4', '=D4*1.1'],
      ['合計', '=SUM(B2:B4)', '=SUM(C2:C4)', '=SUM(D2:D4)', '=SUM(E2:E4)'],
      ['', '', '', '', ''],
      ['数値', '平方根', '2乗', '絶対値', '四捨五入'],
      [16, '=SQRT(A8)', '=POWER(A8,2)', '=ABS(A8)', '=ROUND(A8/3,1)'],
      [-25, '=SQRT(ABS(A9))', '=POWER(A9,2)', '=ABS(A9)', '=ROUND(A9/3,1)'],
      [3.14159, '=SQRT(A10)', '=POWER(A10,2)', '=ABS(A10)', '=ROUND(A10,2)'],
    ],
    expectedResults: {
      'D2': 5000,
      'E2': 5500,
      'D3': 7500,
      'E3': 8250,
      'D4': 8000,
      'E4': 8800,
      'B5': 4300,
      'C5': 18,
      'D5': 20500,
      'E5': 22550,
      'B8': 4,
      'C8': 256,
      'D8': 16,
      'E8': 5.3,
      'B9': 5,
      'C9': 625,
      'D9': 25,
      'E9': -8.3,
      'B10': 1.772,
      'C10': 9.8696,
      'D10': 3.14159,
      'E10': 3.14
    }
  },
  {
    id: 'logical',
    name: '論理関数',
    description: 'IF、AND、OR、比較演算子のテスト',
    color: 'purple',
    data: [
      ['点数', '判定', '合否', 'ランク'],
      [85, '=IF(A2>=80,"合格","不合格")', '=IF(A2>=60,"可","不可")', '=IFS(A2>=90,"A",A2>=80,"B",A2>=70,"C",A2>=60,"D",TRUE,"F")'],
      [92, '=IF(A3>=80,"合格","不合格")', '=IF(A3>=60,"可","不可")', '=IFS(A3>=90,"A",A3>=80,"B",A3>=70,"C",A3>=60,"D",TRUE,"F")'],
      [78, '=IF(A4>=80,"合格","不合格")', '=IF(A4>=60,"可","不可")', '=IFS(A4>=90,"A",A4>=80,"B",A4>=70,"C",A4>=60,"D",TRUE,"F")'],
      [65, '=IF(A5>=80,"合格","不合格")', '=IF(A5>=60,"可","不可")', '=IFS(A5>=90,"A",A5>=80,"B",A5>=70,"C",A5>=60,"D",TRUE,"F")'],
      [40, '=IF(A6>=80,"合格","不合格")', '=IF(A6>=60,"可","不可")', '=IFS(A6>=90,"A",A6>=80,"B",A6>=70,"C",A6>=60,"D",TRUE,"F")'],
      ['', '', '', ''],
      ['売上', '目標', '達成', 'ボーナス'],
      [120000, 100000, '=IF(A9>=B9,"達成","未達成")', '=IF(A9>=B9,A9*0.1,0)'],
      [85000, 100000, '=IF(A10>=B10,"達成","未達成")', '=IF(A10>=B10,A10*0.1,0)'],
      [150000, 100000, '=IF(A11>=B11,"達成","未達成")', '=IF(A11>=B11,A11*0.1,0)'],
    ],
    expectedResults: {
      'B2': '合格',
      'C2': '可',
      'D2': 'B',
      'B3': '合格',
      'C3': '可',
      'D3': 'A',
      'B4': '不合格',
      'C4': '可',
      'D4': 'C',
      'B5': '不合格',
      'C5': '可',
      'D5': 'D',
      'B6': '不合格',
      'C6': '不可',
      'D6': 'F',
      'C9': '達成',
      'D9': 12000,
      'C10': '未達成',
      'D10': 0,
      'C11': '達成',
      'D11': 15000
    }
  },
  {
    id: 'text',
    name: 'テキスト関数',
    description: '文字列操作、結合、抽出のテスト',
    color: 'green',
    data: [
      ['姓', '名', 'フルネーム', 'イニシャル'],
      ['山田', '太郎', '=CONCATENATE(A2," ",B2)', '=CONCATENATE(LEFT(A2,1),".",LEFT(B2,1),".")'],
      ['佐藤', '花子', '=CONCATENATE(A3," ",B3)', '=CONCATENATE(LEFT(A3,1),".",LEFT(B3,1),".")'],
      ['鈴木', '一郎', '=CONCATENATE(A4," ",B4)', '=CONCATENATE(LEFT(A4,1),".",LEFT(B4,1),".")'],
      ['', '', '', ''],
      ['メール', 'ユーザー名', 'ドメイン', '大文字'],
      ['taro.yamada@example.com', '=LEFT(A7,FIND("@",A7)-1)', '=MID(A7,FIND("@",A7)+1,LEN(A7))', '=UPPER(A7)'],
      ['hanako.sato@test.co.jp', '=LEFT(A8,FIND("@",A8)-1)', '=MID(A8,FIND("@",A8)+1,LEN(A8))', '=UPPER(A8)'],
      ['', '', '', ''],
      ['コード', '先頭3文字', '4文字目以降', '長さ'],
      ['ABC12345', '=LEFT(A11,3)', '=MID(A11,4,LEN(A11))', '=LEN(A11)'],
      ['XYZ789', '=LEFT(A12,3)', '=MID(A12,4,LEN(A12))', '=LEN(A12)'],
    ],
    expectedResults: {
      'C2': '山田 太郎',
      'D2': '山.太.',
      'C3': '佐藤 花子',
      'D3': '佐.花.',
      'C4': '鈴木 一郎',
      'D4': '鈴.一.',
      'B7': 'taro.yamada',
      'C7': 'example.com',
      'D7': 'TARO.YAMADA@EXAMPLE.COM',
      'B8': 'hanako.sato',
      'C8': 'test.co.jp',
      'D8': 'HANAKO.SATO@TEST.CO.JP',
      'B11': 'ABC',
      'C11': '12345',
      'D11': 8,
      'B12': 'XYZ',
      'C12': '789',
      'D12': 6
    }
  },
  {
    id: 'datetime',
    name: '日付・時刻関数',
    description: '日付計算、期間計算のテスト',
    color: 'blue',
    data: [
      ['開始日', '終了日', '日数', '営業日数'],
      ['2024-01-01', '2024-12-31', '=DAYS(B2,A2)', '=NETWORKDAYS(A2,B2)'],
      ['2024-03-15', '2024-06-20', '=DAYS(B3,A3)', '=NETWORKDAYS(A3,B3)'],
      ['', '', '', ''],
      ['日付', '年', '月', '日', '曜日'],
      ['2024-07-15', '=YEAR(A6)', '=MONTH(A6)', '=DAY(A6)', '=WEEKDAY(A6)'],
      ['2024-12-25', '=YEAR(A7)', '=MONTH(A7)', '=DAY(A7)', '=WEEKDAY(A7)'],
      ['', '', '', '', ''],
      ['今日の日付', '今の時刻', '30日後', '90日前'],
      ['=TODAY()', '=NOW()', '=TODAY()+30', '=TODAY()-90'],
    ],
    expectedResults: {
      'C2': 365,
      'D2': 262,
      'C3': 97,
      'D3': 70,
      'B6': 2024,
      'C6': 7,
      'D6': 15,
      'E6': 2,
      'B7': 2024,
      'C7': 12,
      'D7': 25,
      'E7': 4
    }
  },
  {
    id: 'statistical',
    name: '統計関数',
    description: '統計計算、集計のテスト',
    color: 'red',
    data: [
      ['データ', '個数', '最大', '最小', '中央値', '標準偏差'],
      [85, '', '', '', '', ''],
      [92, '', '', '', '', ''],
      [78, '', '', '', '', ''],
      [88, '', '', '', '', ''],
      [95, '', '', '', '', ''],
      [82, '', '', '', '', ''],
      ['', '', '', '', '', ''],
      [90, '', '', '', '', ''],
      ['統計', '=COUNTA(A2:A9)', '=MAX(A2:A9)', '=MIN(A2:A9)', '=MEDIAN(A2:A9)', '=STDEV(A2:A9)'],
      ['', '', '', '', '', ''],
      ['カテゴリ', '値', '', 'カテゴリ別集計', ''],
      ['A', 100, '', 'カテゴリA:', '=COUNTIF($A$13:$A$19,"A")'],
      ['B', 150, '', '合計:', '=SUMIF($A$13:$A$19,"A",$B$13:$B$19)'],
      ['A', 120, '', '平均:', '=AVERAGEIF($A$13:$A$19,"A",$B$13:$B$19)'],
      ['C', 80, '', '', ''],
      ['B', 130, '', 'カテゴリB:', '=COUNTIF($A$13:$A$19,"B")'],
      ['A', 110, '', '合計:', '=SUMIF($A$13:$A$19,"B",$B$13:$B$19)'],
      ['C', 90, '', '平均:', '=AVERAGEIF($A$13:$A$19,"B",$B$13:$B$19)'],
    ],
    expectedResults: {
      'B10': 7,
      'C10': 95,
      'D10': 78,
      'E10': 88,
      'F10': 6.24,
      'E13': 3,
      'E14': 330,
      'E15': 110,
      'E17': 2,
      'E18': 280,
      'E19': 140
    }
  },
  {
    id: 'lookup',
    name: '検索・参照関数',
    description: 'VLOOKUP、HLOOKUP、INDEX、MATCHのテスト',
    color: 'cyan',
    data: [
      ['商品コード', '商品名', '単価', '在庫'],
      ['A001', 'ノートPC', 120000, 5],
      ['A002', 'マウス', 3000, 50],
      ['A003', 'キーボード', 8000, 20],
      ['A004', 'モニター', 45000, 8],
      ['', '', '', ''],
      ['検索コード', '商品名', '単価', '在庫'],
      ['A002', '=VLOOKUP(A8,$A$2:$D$5,2,FALSE)', '=VLOOKUP(A8,$A$2:$D$5,3,FALSE)', '=VLOOKUP(A8,$A$2:$D$5,4,FALSE)'],
      ['A004', '=VLOOKUP(A9,$A$2:$D$5,2,FALSE)', '=VLOOKUP(A9,$A$2:$D$5,3,FALSE)', '=VLOOKUP(A9,$A$2:$D$5,4,FALSE)'],
      ['A001', '=VLOOKUP(A10,$A$2:$D$5,2,FALSE)', '=VLOOKUP(A10,$A$2:$D$5,3,FALSE)', '=VLOOKUP(A10,$A$2:$D$5,4,FALSE)'],
      ['', '', '', ''],
      ['順位', '1位', '2位', '3位'],
      ['商品名', '=INDEX($B$2:$B$5,MATCH(LARGE($C$2:$C$5,1),$C$2:$C$5,0))', '=INDEX($B$2:$B$5,MATCH(LARGE($C$2:$C$5,2),$C$2:$C$5,0))', '=INDEX($B$2:$B$5,MATCH(LARGE($C$2:$C$5,3),$C$2:$C$5,0))'],
    ],
    expectedResults: {
      'B8': 'マウス',
      'C8': 3000,
      'D8': 50,
      'B9': 'モニター',
      'C9': 45000,
      'D9': 8,
      'B10': 'ノートPC',
      'C10': 120000,
      'D10': 5,
      'B13': 'ノートPC',
      'C13': 'モニター',
      'D13': 'キーボード'
    }
  }
];